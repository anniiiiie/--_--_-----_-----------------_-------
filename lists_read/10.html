<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Геоинформационные Системы</title>
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/1.css">
</head>
<body>

    <header>
        <h1>Геоинформационные Системы</h1>
        <h3>Н.А. Кащенко, Е.В. Попов, А.В. Чечин</h3>
        <div class="navbar">
            <a href="../index.html">Главная</a>
            <a href="soderjaniye.html">Содержание</a>
            <a href="opredeleniya_list.html">Определения и аббревиатуры</a>
            <a href="spisok_liter.html">Список литературы</a>
            <a href="../test/test_list.html">Тест</a>
            <a href="https://bibl.nngasu.ru/electronicresources/uch-metod/geodesy/847228.pdf">Скачать PDF</a>
        </div>
    </header>
    
    <button class="toggle-button" id="toggle-button"><img src="../icons/list.png" width="100%"></button>
    <div class="sidebar" id="sidebar">
        <h2>Содержание</h2>
        <a href="vved.html">Введение</a>
        <a href="1.html#section_1"><b>Раздел 1</b> Геоинформационные системы и их классификация</a>
        <a href="1.html#1_1" class="tab">1.1. Геоинформационные системы</a>
        <a href="1.html#1_2" class="tab">1.2. Классификация ГИС</a>
        <a href="1.html#1_3" class="tab">1.3. Подсистемы ГИС</a>
        <a href="1.html#1_4" class="tab">1.4. История ГИС</a>
    
        <a href="2.html#section_2"><b>Раздел 2</b> Растровая модель данных</a>
        <a href="2.html#2_1" class="tab">2.1. Характеристики растровых моделей</a>
        <a href="2.html#2_2" class="tab">2.2. Достоинства и недостатки растровых моделей</a>
        <a href="2.html#2_3" class="tab">2.3. Методы сжатия растровых данных</a>
    
        <a href="3.html#section_3"><b>Раздел 3</b> Векторная модель данных</a>
        <a href="3.html#3_1" class="tab">3.1. Векторная модель данных</a>
        <a href="3.html#3_2" class="tab">3.2. Пространственные предметы в ГИС</a>
        <a href="3.html#3_3" class="tab">3.3. Векторные топологические модели</a>
        <a href="3.html#3_4" class="tab">3.4. Сравнение растровой и векторной модели данных. Достоинства и недостатки</a>
        <a href="3.html#3_4_1" class="tab-tab">3.4.1. Точность координат</a>
        <a href="3.html#3_4_2" class="tab-tab">3.4.2. Представление территории и объектов местности</a>
        <a href="3.html#3_4_3" class="tab-tab">3.4.3. Хранение информации</a>
    
        <a href="4.html#section_4"><b>Раздел 4</b> Ввод данных</a>
        <a href="4.html#4_1" class="tab">4.1. Формы и устройства ввода данных</a>
        <a href="4.html#4_2" class="tab">4.2. Ввод геоданных</a>
        <a href="4.html#4_3" class="tab">4.3. Процедура векторизации</a>
        <a href="4.html#4_3_1" class="tab-tab">4.3.1. Регистрация растрового изображения</a>
        <a href="4.html#4_3_2" class="tab-tab">4.3.2. Создание слоёв</a>
        <a href="4.html#4_3_3" class="tab-tab">4.3.3. Векторизация</a>
        <a href="4.html#4_3_4" class="tab-tab">4.3.4. Сборка полигонов</a>
        <a href="4.html#4_3_5" class="tab-tab">4.3.5. Поиск и коррекция ошибок</a>
        <a href="4.html#4_3_6" class="tab-tab">4.3.6. Идентификация и ввод атрибутивных данных</a>
        <a href="4.html#4_4" class="tab">4.4 Картографические проекции. Трансформация координат</a>
        <a href="4.html#4_4_1" class="tab-tab">4.4.1. Общие системы координат</a>
        <a href="4.html#4_4_2" class="tab-tab">4.4.2. Хранение координат в ГИС</a>
        <a href="4.html#4_4_3" class="tab-tab">4.4.3. Картографические проекции</a>
        <a href="4.html#4_4_4" class="tab-tab">4.4.4. Трансформация координат</a>
    
        <a href="5.html#section_5"><b>Раздел 5</b> Атрибутивные базы данных</a>
        <a href="5.html#5_1" class="tab">5.1. Основные элементы базы данных ГИС</a>
        <a href="5.html#5_2" class="tab">5.2. Системы управления базами данных</a>
        <a href="5.html#5_3" class="tab">5.3. Классификация БД</a>
    
        <a href="6.html#section_6" ><b>Раздел 6</b> Анализ и запросы в ГИС</a>
        <a href="6.html#6_1" class="tab">6.1. Аналитические функции ГИС</a>
        <a href="6.html#6_2" class="tab">6.2. Анализ объектов в ГИС</a>
        <a href="6.html#6_2_1" class="tab-tab">6.2.1. Анализ одного класса объектов</a>
        <a href="6.html#6_2_2" class="tab-tab">6.2.2. Анализ объектных пар</a>
        <a href="6.html#6_2_3" class="tab-tab">6.2.3. Анализ нескольких классов объектов</a>
        <a href="6.html#6_2_4" class="tab-tab">6.2.4. Формирование новых объектов</a>
        <a href="6.html#6_3" class="tab">6.3. Типичные запросы</a>
        <a href="6.html#6_4" class="tab">6.4. SQL-запросы</a>
        <a href="6.html#6_5" class="tab">6.5. Оверлей. Пространственные запросы в ГИС</a>
    
        <a href="7.html#section_7"><b>Раздел 7</b> Тематическое картографирование</a>
        <a href="7.html#7_1" class="tab">7.1. Введение в тематическое картографирование</a>
        <a href="7.html#7_2" class="tab">7.2. Качественный метод</a>
        <a href="7.html#7_3" class="tab">7.3. Количественный метод</a>
        <a href="7.html#7_4" class="tab">7.4. Картодиаграммы</a>
        <a href="7.html#7_5" class="tab">7.5. Картографическая легенда</a>
        <a href="7.html#7_6" class="tab">7.6. Библиотеки условных знаков и классификаторы</a>
    
        <a href="8.html#section_8"><b>Раздел 8</b> Вывод данных</a>
        <a href="8.html#8_1" class="tab">8.1. Формы и устройства вывода данных</a>
        <a href="8.html#8_2" class="tab">8.2. Компоновка графического вывода</a>
        <a href="8.html#8_2_1" class="tab-tab">8.2.1. Типы выводимых данных</a>
        <a href="8.html#8_2_2" class="tab-tab">8.2.2. Картографическая основа</a>
        <a href="8.html#8_2_3" class="tab-tab">8.2.3. Общая графическая компоновка</a>
        <a href="8.html#8_2_4" class="tab-tab">8.2.4. Вывод карт на экране</a>
        <a href="8.html#8_2_5" class="tab-tab">8.2.5. Размещение надписей</a>
    
        <a href="9.html#section_9"><b>Раздел 9</b> Поверхности в ГИС. Цифровая модель рельефа (ЦМР)</a>
        <a href="9.html#9_1" class="tab">9.1. Виды цифровых моделей рельефа</a>
        <a href="9.html#9_2" class="tab">9.2. Способы создания поверхностей в ГИС</a>
        <a href="9.html#9_3" class="tab">9.3. Использование поверхностей при решении практических задач</a>
    
        <a href="10.html#section_10"><b>Раздел 10</b> Автоматизация в ГИС</a>
        <a href="10.html#10_1" class="tab">10.1. Макросы</a>
        <a href="10.html#10_2" class="tab">10.2. Программные приложения</a>
        <a href="10.html#10_3" class="tab">10.3. Основные элементы программного приложения (Application)</a>
        <a href="10.html#10_4" class="tab">10.4. Структура программного приложения</a>
        <a href="10.html#10_5" class="tab">10.5. Работа с графическими объектами и картой</a>
        <a href="10.html#10_6" class="tab">10.6. Интерфейс пользователя</a>
        <a href="10.html#10_7" class="tab">10.7. Программные компоненты</a>
        <a href="zakl.html" style="margin-bottom: 10%;">Заключение</a>
    </div>

<p></p>

<div class="content">
    <button id="scrollToTop"><img src="../icons/arrow_circle_up.png" width="35%" height="35%"></button>

    <h2 id="section_10">РАЗДЕЛ 10. АВТОМАТИЗАЦИЯ В ГИС</h2>
    <h2 id="10_1"> 10.1.	Макросы</h2>
    <p>Макрос представляет собой определенную команду (макрокоманду), которая решает заданную в ГИС задачу. Как правило, в ГИС присутствует доступный список макрокоманд, пользователь только редактирует параметры макроса.</p>
    <p>Рассмотрим часто используемые макросы (на примере ГИС Географ) [15]:</p>
    <ul>
        <li>открыть форму Open Form <имя>;</li>
        <li>выполнить запрос Run Query <имя>;</li>
        <li>открыть окно карты Open Map <имя>;</li>
        <li>активировать тему Set Theme <имя>;</li>
        <li>открыть таблицу Open Table <имя>.</li>
    </ul>
    <p>Макрос, как правило, привязывается к кнопке панели инструментов или к кнопке пользовательской формы.</p>
    <h2 id="10_2"></h2>    
    <p>Многие ГИС имеют встроенные языки программирования, например, MapInfo – MapBasic, ArcView – Avenue и т.д. Как правило, они базируются на языке Basic. Некоторые системы позволяют записывать макросы и открывать их в виде программного модуля с готовым текстом программы, который пользователь может изменить по своему усмотрению.</p>
    <p>Программа, написанная на встроенном языке для конкретной системы, называется программным приложением (Application). Приложение пишется, как правило, в отдельном модуле или окне, похожем на текстовый редактор. Программы сохраняются в виде текстовых файлов. Часто после создания приложения его необходимо компилировать. В результате компиляции получается программный файл, запускаемый только внутри данной ГИС (.mbx) [6].</p>
    <p>Программное приложение может иметь большой размер и включать несколько модулей. Модули объединяются в проекты. Проект представляет собой небольшой текстовый файл, включающий ссылки на используемые модули. Внутри этих модулей должна быть только одна главная процедура (Sub Main). В другие проекты можно подключать уже существующие модули, тем самым сокращая объем работ (рис. 10.1.).</p>
    <div class="img">
        <img src="../pic/Рис_10-1.PNG">
        <p class="picture_caption">Рис 10.1. Структура проектов</p>
    </div>
    <p>Если какой-либо модуль внутри проекта ссылается на процедуру/функцию, содержащуюся в неподключенном модуле, проект не откомпилируется и не заработает. Все используемые модули должны быть подключены. После редактирования модуля необходимо заново выполнить компиляцию модуля, а затем компиляцию проекта [6].</p>    
    <h2 id="10_3">10.3.	Основные элементы программного приложения (Application)</h2>
    <p>1.	<i>Переменные.</i> Переменная представляет собой именованное место в памяти, значение которого можно изменять. Переменные бывают следующих типов:</p>
    <p>·     целое (integer);</p>
    <p>·     десятичное (float, decimal);</p>
    <p>·     строковое (string);</p>
    <p>·     логическое (logical, boolean);</p>
    <p>·     дата (date);</p>
    <p>·     variant (может включаться любое значение).</p>
    <p>Для	преобразования	переменной	из	одного	типа	в	другой	существуют специальные функции, например:</p>
    <p style="text-align: center;">A = StrToFloat (B) </p>
    <p style="text-align: center;">B = FloatToStr (A)</p>
    <p>Имя переменной должно быть зарезервировано в начале программы или функции соответствующим оператором, например:</p>
    <p>Dim A as integer    <i>‘резервирование переменной A</i></p>
    <p>A = 5 <i>‘задание значения переменной A</i></p>
    <p>2.	<i>Константы</i> похожи на переменные, но их значения в процессе работы всей программы не изменяются (например, π = 3,14). Использование констант позволяет быть уверенным, что их значение не будет изменено в процессе программы из-за ошибочного кодирования.</p>
    <p>3.	<i>Выражения.</i> Математическое выражение может включать соответственно
    «* / + - ». Для группировки операций используются скобки. Используют логические условия «< >, = , AND, OR».
    </p>
    <p>4.	<i>Операторы цикла.</i> Операторы цикла предназначены для выполнения повторных операций.</p>
    <p>–	Оператор FOR: <i>‘предназначен для выполнения цикличных операций</i></p>
    <p>FOR I = 1 TO 5 <i>‘выполнять до тех пока I от 1 до 5</i></p>
    <p>{тело цикла }</p>
    <p>NEXT <i>‘следующее значение I</i></p>
    <p>– Оператор WHILE: <i>‘количество циклов ограничено условием</i></p>
    <p>DO WHILE I<10 <i>‘выполнять пока I меньше 10</i></p>
    <p>{тело цикла}</p>
    <p>LOOP <i>‘повтор операции</i></p>
    <p>5.	<i>Операторы условий.</i> Позволяют активировать команды в зависимости от определенных условий.</p>
    <p>–	IF <условие> THEN <i>‘если условие верно то</i></p>
    <p><оператор1></p>
    <p>ELSE <оператор 2> <i>‘если нет то</i></p>
    <p>END IF <i>‘окончание оператора условия</i></p>
    <p>6.	<i>Процедуры.</i> Процедура представляет собой подпрограмму с последующим набором команд. Использование периодически повторяющихся процедур позволяет значительно сократить текст программы и унифицировать ее. Процедура вызывается соответствующим оператором Call. Процедура должна декларироваться в начале модуля.</p>
    <p>Declare Sub Proc1       <i>‘декларирование процедуры</i></p>
    <p>...</p>
    <p>Sub Proc1 <i>‘содержимое процедуры</i></p>
    <p><тело> </p>
    <p>END Sub</p>
    <p>...</p>
    <p>Call Proc1 <i>‘вызов процедуры</i></p>
    <p>7.	<i>Функции</i></p>
    <p>Функция аналогична процедуре, только после вызова возвращает какое-то значение и в своем описании должна включать тип возвращаемой переменной. Возвращенное значение присваивается переменной.</p>
    <p>Declare Function Func1 as string    <i>‘декларирование функции</i></p>
    <p>...</p>
    <p>Function Func1 as string	<i>‘содержимое функции</i></p>
    <p><тело></p>
    <p>Func1= «значение» </p>
    <p>END Function</p>
    <p>...</p>
    <p>Dim A1 as String <i>‘резервирование переменной A1</i></p>
    <p>...</p>
    <p>A1 = Func1	<i>‘вызов функции</i></p>
    <p>При вызове имя функции должно стоять после имени переменной. Типы переменных функции и переменной, которой присваивается значение, должны совпадать.</p>
    <h2 id="10_4">10.4.	Структура программного приложения</h2>
    <p>Рассмотрим структуру программного приложения на примере MapBasic [10.2]:</p>
    <img src="../pic/таб_1.png">
    <p>В проекте в одном из модулей обязательно присутствует процедура Main.
    Именно она активируется при запуске приложения.
    </p>
    <h2 id="10_5">10.5.	Работа с графическими объектами и картой</h2>
    <p>Встроенный в ГИС язык программирования имеет специальные команды для работы с картой. Например: открыть карту, задать масштаб отображения, задать координаты центра окна, добавить (исключить) слой, создать тематическую карту и добавить в окно карты, уменьшить/увеличить, задать условные знаки слою, переместить слой вверх или вниз в порядке отображения и т.д.</p>
    <p>Также присутствует специальные команды создания объектов геометрии по координатам. Геометрические объекты создаются как отдельный тип – специальные графические переменные. Созданные графические объекты- переменные затем можно добавить в выбранный слой. Команды создания графических объектов:</p>
    <p>Create Point (х;у) <i>‘создание точки по координатам x,y</i></p>
    <p>Create Pline <i>‘создание полилинии </i></p>
    <p>Create Region <i>‘создание полигона</i> </p>
    <p>Create Text <i>‘создание текста</i></p>
    <p>В полилиниях и регионах количество точек меняется, поэтому вначале запускается команда «создать объект» – создается пустой объект, затем необходимое количество раз запускается команда «добавить узел» (Add Node) с заданными координатами.</p>
    <h2 id="10_6">10.6.	Интерфейс пользователя</h2>
    <p>Язык программирования включает специальные команды, позволяющие организовать интерфейс пользователя.</p>
    <p>1.	<i>Меню.</i> Пример представлен на рис. 10.2.</p>
    <div class="img">
        <img src="../pic/Рис_10-2.jpg">
        <p class="picture_caption">Рис. 10.2. Меню ПО ArcGIS</p>
    </div>
    <p>Create Menu <имя></p>
    <p>Меню включает пункты, каждый из которых ссылается на процедуру (например, открыть файл Call Open File).</p>
    <p>Созданное меню собирается в строку меню MenuBar (Create MenuBar)</p>
    <p>2.	<i>Диалоговые окна.</i> Пример представлен на рис. 10.3.</p>
    <p>Система позволяет создавать диалоговые окна, задавая в нужном месте соответствующие элементы. Значение каждого элемента сохраняется в соответствующей переменной. После нажатия кнопки, например «OK», запускается заданная ей процедура, которая в своем теле может использовать введенные в диалоговом окне переменные.</p>
    
    <div class="img">
        <img src="../pic/Рис_10-3.jpg">
        <p class="picture_caption">Рис. 10.3. Диалоговое окно</p>
    </div>
    <p>Основные элементы диалоговых окон представлены в табл. 10.1.</p>
    <p>3.	<i>Панели инструментов.</i> Пример панели инструментов представлен на рис. 10.4.</p>
    <div class="img">
        <img src="../pic/Рис_10-4.jpg">
        <p class="picture_caption">Рис. 10.4. Панель инструментов MapInfo</p>
    </div>
    <p>Можно создавать кнопки, подключать к ним пиктограммы и задавать процедуру, которая запускается при нажимании кнопки. Кнопки объединяются в панели инструментов.</p>
    <p>Кнопки бывают разных типов: обычные, залипающие и задающие функции карты. В ГИС также присутствуют кнопки, позволяющие работать с картой и считывать с нее координаты под мышью. Процедура запускается только после нажатия мыши и в качестве переменных включает координаты х,у в окне карты.</p>
    <p style="text-align: right;">Таблица 10.1.</p>
    <div class="img">
        <img src="../pic/таб_10-1.PNG">        
    </div>

    <h2 id="10_7">10.7.	Программные компоненты</h2>
    <p>Существуют ГИС-компоненты, созданные по технологии ActivX, которые можно добавлять в любой современный визуальный язык программирования (Visual Basic, Visual C, Delphi). В результате в данном языке появляются дополнительные команды работы с картой. Многие крупные разработчики ГИС продают такие компоненты (ESRI – Map Object, MapInfo - MapX и т.п.) и лицензии на клиентские места.</p>
    <p></p>
    
    <h3>Вопросы:</h3>
    <ol>
        <li>Что такое макросы?</li>
        <li>Для чего используются программные приложения?</li>
        <li>Назовите основные элементы программного приложения.</li>
        <li>Назовите основные структурные элементы приложения.</li>
        <li>Для чего служат инструменты создания интерфейса пользователя?</li>
        <li>Что такое программные компоненты?</li>
    </ol>
    
        <div class="footer">
            <button id="but1back" class="teleportation"> 
                <img src="../icons/arrow_back.png" alt="back" width="10%" style="vertical-align: middle;"><a href="9.html">Предыдущий раздел</a></button>
            <button id="but1forw" class="teleportation">
                <a href="zakl.html">Следующий раздел</a><img src="../icons/arrow_forward.png" alt="back" width="10%" style="vertical-align: middle;"> </button>
        </div>
</div>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.3/jquery.min.js"></script>
<script type="text/javascript" src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script src="../js/main.js"></script>
</body>
</html>

